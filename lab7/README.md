# Лабораторная работа №7: Исследование факторов и организация работы с таблицами данных

*Данные*: data_purch.xlsx

## Группировка данных

Были взяты данные изначальные факторы и сгруппированы по `purchase_number`:

- `placing_base_name`: разные формы проведения торгов могут иметь разную степень конкуренции и прозрачности, а также обязательства
- `lot_price_correct`: если максимально возможная цена слишком низкая, то поставщики могут не заинтересоваться участием в закупке.
- `drug_qty`: большие объемы закупок могут привлекать больше поставщиков и увеличивать конкуренцию
- `drug_position_price`: аналогично `lot_price_correct`
- `is_abnd`: целевая переменная, которая указывает на то, состоялась ли закупка или нет
- `is_znvlp`: закупки препаратов из списка ЖВЛП могут регулироваться более строго и иметь больше требований к поставщикам
- `is_povt`: если процедуру заказчик вынужден повторить, это может указывать на проблемы с предыдущей попыткой проведения закупки, допустим, не смог найти поставщика
- `is_dif`: закупка дефицитных препаратов может быть более сложной из-за ограниченного количества поставщиков и доступности препаратов
- `app_amount_absolute_correct`: большие суммы залога могут быть барьером для участия некоторых поставщиков в закупке

## Формирование новых факторов

- Преобразование категориальной переменной `placing_base_name` с помощью горячего кодирования
- Метод главных компонент
- Факторный анализ
- `app_amount_ratio`: отношение суммы залога к максимально возможной цене за все лекарства в закупке
- `is_high_value`: бинарный фактор, который устанавливается в 1, если `lot_price_correct` выше 75-го процентиля всех значений в этом столбце, и 0 в противном случае. Он будет указывать на то, является ли закупка высокоценной партией
- `is_large_qty`: бинарный фактор, который устанавливается в 1, если `drug_qty` выше 75-го процентиля всех значений в этом столбце, и 0 в противном случае. Он будет указывать на то, является ли закупка большим количеством лекарств

## Оценка важности факторов на основе метода "Дерево решений" 

Проведём разделение на обучающую и тестовую выборку и применим метод "Дерево решений"
![image](https://user-images.githubusercontent.com/50529632/228937109-523c3772-34d7-42dc-83e3-ae0e86c40884.png)
Получим 5 наиболее важных факторов: `lot_price_correct`, `PCA`, `drug_position_price`, `drug_qty`, `FA`

## Построение логистической регрессии

После оценки важности оставляем только 5 наиболее важных факторов на нашей обучающей и тестовой выборке.

Точность модели на обучающей выборке: **0.5090608875128999**

Точность модели на тестовой выборке: **0.5050292397660818**

Точность около 0.5 означает, что модель правильно соотносит 50% объектов. Это равносильно случайному угадыванию. Таким образом, точность является низкой и указывает на то, что модель не может надежно предсказывать целевую переменную, поэтому данные факторы и модель не особо могут быть пригодными для использования
