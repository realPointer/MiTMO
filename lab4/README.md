# Лабораторная работа №5: Методы, основанные на деревьях решений. Деревья классификации. Случайный лес

Точность всех моделей оценивается методом перекрёстной проверки по 5 блокам.

_Модели_: дерево классификации, случайный лес

_Данные_: `winequality-white_for_lab` (источник: https://github.com/ania607/ML/blob/main/data/winequality-white_for_lab.csv)

# Загрузка данных

Загружаем данные и откладываем 15% наблюдений для прогноза.

# Предварительный анализ данных

Выводы по описательным статистикам: значения объясняющих переменных положительные, масштабы измерения отличаются. Убираем `quality` из-за нулевой дисперсии

![image](https://user-images.githubusercontent.com/50529632/202869054-a7249ead-6152-4b16-888a-55ac8bc9b794.png)
![image](https://user-images.githubusercontent.com/50529632/202869057-47692abc-4336-4e8d-a9b6-ea3faec69b65.png)
![image](https://user-images.githubusercontent.com/50529632/202869058-8dd25f0b-5ca2-4ea2-9afa-26c2c2234177.png)


# Дерево на всех признаках    

Построим модель и выведем изображение дерева в виде текста.  
Дерево получилось слишком большое для отображения в текстовом формате. Графическая визуализация тоже не поможет в данном случае. Посчитаем показатели точности с перекрёстной проверкой.

Модель `one_tree`, перекрёстная проверка *Acc = 0.759*

# Пример визуализации небольшого дерева
![image](https://user-images.githubusercontent.com/50529632/202869142-fe737dba-4b7f-4fa5-a896-0461705747ea.png)

# Случайный лес

У модели случайного леса два настроечных параметра: количество деревьев $B$ и количество признаков для построения отдельного дерева $m$.

![image](https://user-images.githubusercontent.com/50529632/202869152-423218e2-870a-4d47-bbfd-aa3bdc379e54.png)

Модель `random_forest_GS`, перекрёстная проверка $Acc = 0.832$

## Прогноз на отложенные наблюдения по лучшей модели
| |Модель|	Acc|
| :---: | :---: | :---: |
|0 |	one_tree |	0.759 |
|1 |	random_forest_GS |	0.832 |

Все модели показывают среднюю точность по показателю $Acc$, при этом самой точной оказывается модель случайного леса. Сделаем прогноз на отложенные наблюдения.  

|| precision | recall | f1-score | support |
| :---: |     :---:      | :---: | :---: | :---: |
| 0 | 0.77 | 0.70 | 0.73 | 241 |
| 1 | 0.86 | 0.90 | 0.88 | 494 |
| accuracy | | | 0.83 | 735 |
| macro avg| 0.82 | 0.80 | 0.81 | 735 |
| weighted avg | 0.83 | 0.83 | 0.83 | 735 |
